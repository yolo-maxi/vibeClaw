// ReviewPanel - Self-contained styles (no Tailwind dependency)
// Matches the styling pattern of page-toolbar-css

// =============================================================================
// Variables
// =============================================================================

$blue: #3c82f7;
$purple: #8b5cf6;
$green: #34c759;
$red: #ff3b30;
$amber: #f59e0b;
$orange: #f97316;
$cyan: #06b6d4;

// Dark mode colors
$dark-bg: rgba(15, 23, 42, 0.95);
$dark-border: #334155;
$dark-text: #fff;
$dark-text-secondary: #94a3b8;
$dark-text-muted: #64748b;
$dark-hover: rgba(51, 65, 85, 0.5);
$dark-divider: #1e293b;
$dark-footer: rgba(30, 41, 59, 0.5);
$dark-button: rgba(51, 65, 85, 0.5);
$dark-button-hover: #334155;

// Light mode colors
$light-bg: rgba(255, 255, 255, 0.95);
$light-border: #e5e7eb;
$light-text: #111827;
$light-text-secondary: #6b7280;
$light-text-muted: #9ca3af;
$light-hover: #f9fafb;
$light-divider: #f3f4f6;
$light-footer: #f9fafb;
$light-button: #f3f4f6;
$light-button-hover: #e5e7eb;

// =============================================================================
// Keyframes
// =============================================================================

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@keyframes panelEnter {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(8px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

@keyframes modalEnter {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes backdropEnter {
  from { opacity: 0; }
  to { opacity: 1; }
}

// =============================================================================
// Toggle Button
// =============================================================================

// Toggle button - sits inside the toolbar as a regular button
.toggleButton {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 34px;
  height: 34px;
  border-radius: 50%;
  border: none;
  background: transparent;
  cursor: pointer;
  transition: all 0.15s ease;
  color: rgba(0, 0, 0, 0.6);
  font-size: 14px;

  &:hover {
    background: rgba(0, 0, 0, 0.05);
    color: rgba(0, 0, 0, 0.9);
  }

  &.active {
    color: $purple;
    background: rgba($purple, 0.2);
  }
}

.badge {
  position: absolute;
  top: -2px;
  right: -2px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 16px;
  height: 16px;
  padding: 0 4px;
  font-size: 10px;
  font-weight: 700;
  color: white;
  background: $purple;
  border-radius: 9999px;
}

// =============================================================================
// Panel Container
// =============================================================================

// Panel - positioned above the toolbar, never overlapping
.panel {
  position: fixed;
  bottom: 72px; // Above the toolbar (toolbar is ~56px + 16px gap)
  right: 20px;
  z-index: 100003;
  width: 384px;
  max-height: 60vh;
  background: $dark-bg;
  border: 1px solid $dark-border;
  border-radius: 12px;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  animation: panelEnter 0.2s cubic-bezier(0.34, 1.2, 0.64, 1);

  &.light {
    background: $light-bg;
    border-color: $light-border;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
  }
}

// =============================================================================
// Header
// =============================================================================

.header {
  padding: 16px;
  border-bottom: 1px solid $dark-border;

  .light & {
    border-color: $light-border;
  }
}

.headerTop {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}

.title {
  font-size: 18px;
  font-weight: 600;
  color: $dark-text;

  .light & {
    color: $light-text;
  }
}

.headerActions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.iconButton {
  padding: 6px;
  border: none;
  background: transparent;
  cursor: pointer;
  transition: color 0.15s ease;
  color: $dark-text-secondary;
  border-radius: 4px;

  &:hover {
    color: $dark-text;
  }

  .light & {
    color: $light-text-muted;

    &:hover {
      color: $light-text-secondary;
    }
  }

  &.active {
    color: $purple;
  }

  svg {
    display: block;
  }
}

.spinner {
  animation: spin 1s linear infinite;
}

// =============================================================================
// Filters
// =============================================================================

.filters {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.filterButton {
  padding: 4px 12px;
  font-size: 12px;
  font-weight: 500;
  border: none;
  border-radius: 9999px;
  cursor: pointer;
  transition: all 0.15s ease;
  background: #1e293b;
  color: $dark-text-secondary;

  &:hover {
    color: $dark-text;
  }

  &.active {
    background: #475569;
    color: $dark-text;
  }

  &.highlight {
    background: rgba($purple, 0.2);
    color: rgba($purple, 0.9);

    &:hover {
      background: rgba($purple, 0.3);
    }

    &.active {
      background: $purple;
      color: white;
    }
  }

  .light & {
    background: $light-button;
    color: $light-text-secondary;

    &:hover {
      color: $light-text;
    }

    &.active {
      background: #d1d5db;
      color: $light-text;
    }

    &.highlight {
      background: rgba($purple, 0.2);
      color: $purple;

      &:hover {
        background: rgba($purple, 0.3);
      }

      &.active {
        background: $purple;
        color: white;
      }
    }
  }
}

.hiddenInfo {
  font-size: 12px;
  color: $dark-text-muted;

  .light & {
    color: $light-text-muted;
  }
}

// =============================================================================
// Annotation List
// =============================================================================

.listContainer {
  flex: 1;
  overflow-y: auto;
}

.emptyState {
  padding: 32px;
  text-align: center;
  color: $dark-text-secondary;

  .light & {
    color: $light-text-secondary;
  }
}

.list {
  & > * + * {
    border-top: 1px solid $dark-divider;
  }

  .light & > * + * {
    border-color: $light-divider;
  }
}

// =============================================================================
// Annotation Item
// =============================================================================

.item {
  padding: 16px;
  transition: background 0.15s ease;

  &:hover {
    background: $dark-hover;
  }

  .light &:hover {
    background: $light-hover;
  }
}

.itemHeader {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 8px;
}

.itemHeaderLeft {
  display: flex;
  align-items: center;
  gap: 8px;
}

.timeAgo {
  font-size: 12px;
  color: $dark-text-muted;

  .light & {
    color: $light-text-muted;
  }
}

.owner {
  font-size: 12px;
  color: $dark-text-muted;

  &.isOwn {
    color: $cyan;
  }

  .light & {
    color: $light-text-muted;

    &.isOwn {
      color: darken($cyan, 10%);
    }
  }
}

.comment {
  font-size: 14px;
  margin-bottom: 8px;
  color: #cbd5e1;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;

  .light & {
    color: #374151;
  }
}

.element {
  font-size: 12px;
  font-family: monospace;
  margin-bottom: 12px;
  color: $dark-text-muted;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  .light & {
    color: $light-text-muted;
  }
}

// =============================================================================
// Actions
// =============================================================================

.actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.actionButton {
  flex: 1;
  padding: 6px 12px;
  font-size: 12px;
  font-weight: 500;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.15s ease;

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
}

.approveButton {
  background: rgba($green, 0.2);
  color: $green;

  &:hover:not(:disabled) {
    background: rgba($green, 0.3);
  }
}

.editButton {
  background: rgba($purple, 0.2);
  color: $purple;

  &:hover:not(:disabled) {
    background: rgba($purple, 0.3);
  }
}

.rejectButton {
  background: rgba($red, 0.2);
  color: $red;

  &:hover:not(:disabled) {
    background: rgba($red, 0.3);
  }
}

.cancelButton {
  @extend .rejectButton;
  flex: 0;
}

.hideButton {
  flex: 0;
  background: $dark-button;
  color: #94a3b8;

  &:hover:not(:disabled) {
    background: $dark-button-hover;
  }

  .light & {
    background: $light-button;
    color: $light-text-secondary;

    &:hover:not(:disabled) {
      background: $light-button-hover;
    }
  }
}

.unhideButton {
  @extend .hideButton;
}

// =============================================================================
// Commit Info
// =============================================================================

.commitInfo {
  font-size: 12px;
  font-family: monospace;
  margin-top: 8px;
  color: #475569;

  .light & {
    color: #9ca3af;
  }
}

// =============================================================================
// Status Badge
// =============================================================================

.statusBadge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  font-size: 12px;
  font-weight: 500;
  border-radius: 9999px;
}

// Status colors - dark mode
.statusPending { background: rgba($amber, 0.2); color: #fbbf24; }
.statusProcessing { background: rgba($blue, 0.2); color: #60a5fa; }
.statusImplemented { background: rgba($purple, 0.2); color: #a78bfa; }
.statusApproved { background: rgba($green, 0.2); color: #4ade80; }
.statusCompleted { background: rgba($green, 0.2); color: #4ade80; }
.statusRejected { background: rgba($red, 0.2); color: #f87171; }
.statusRevision { background: rgba($orange, 0.2); color: #fb923c; }
.statusFailed { background: rgba($red, 0.2); color: #ef4444; }
.statusInterrupted { background: rgba(#6b7280, 0.2); color: #9ca3af; }
.statusArchived { background: rgba(#6b7280, 0.2); color: #6b7280; }

// Status colors - light mode
.light {
  .statusPending { background: rgba($amber, 0.1); color: darken($amber, 10%); }
  .statusProcessing { background: rgba($blue, 0.1); color: darken($blue, 10%); }
  .statusImplemented { background: rgba($purple, 0.1); color: darken($purple, 10%); }
  .statusApproved { background: rgba($green, 0.1); color: darken($green, 10%); }
  .statusCompleted { background: rgba($green, 0.1); color: darken($green, 10%); }
  .statusRejected { background: rgba($red, 0.1); color: darken($red, 10%); }
  .statusRevision { background: rgba($orange, 0.1); color: darken($orange, 10%); }
  .statusFailed { background: rgba($red, 0.1); color: darken($red, 5%); }
  .statusInterrupted { background: rgba(#6b7280, 0.1); color: #4b5563; }
  .statusArchived { background: rgba(#6b7280, 0.1); color: #6b7280; }
}

// =============================================================================
// Footer
// =============================================================================

.footer {
  padding: 12px;
  border-top: 1px solid $dark-border;
  background: $dark-footer;
  text-align: center;

  .light & {
    border-color: $light-border;
    background: $light-footer;
  }
}

.footerText {
  font-size: 12px;
  color: $dark-text-muted;

  .light & {
    color: $light-text-muted;
  }
}

.userName {
  color: $cyan;
}

.adminBadge {
  color: #eab308;
  margin-left: 4px;
}

// =============================================================================
// Revision Modal
// =============================================================================

.modalBackdrop {
  position: fixed;
  inset: 0;
  z-index: 100010;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(4px);
  animation: backdropEnter 0.15s ease;
}

.modal {
  width: 100%;
  max-width: 512px;
  margin: 0 16px;
  background: $dark-bg;
  border: 1px solid $dark-border;
  border-radius: 12px;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
  animation: modalEnter 0.2s cubic-bezier(0.34, 1.2, 0.64, 1);

  &.light {
    background: white;
    border-color: $light-border;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
  }
}

.modalHeader {
  padding: 16px;
  border-bottom: 1px solid $dark-border;

  .light & {
    border-color: $light-border;
  }
}

.modalTitle {
  font-size: 18px;
  font-weight: 600;
  color: $dark-text;

  .light & {
    color: $light-text;
  }
}

.modalSubtitle {
  font-size: 14px;
  margin-top: 4px;
  color: $dark-text-secondary;

  .light & {
    color: $light-text-secondary;
  }
}

.modalBody {
  padding: 16px;
}

.originalRequest {
  margin-bottom: 16px;
  padding: 12px;
  background: rgba(30, 41, 59, 0.5);
  border-radius: 8px;

  .light & {
    background: #f9fafb;
  }
}

.originalLabel {
  font-size: 12px;
  margin-bottom: 4px;
  color: $dark-text-muted;

  .light & {
    color: $light-text-muted;
  }
}

.originalText {
  font-size: 14px;
  color: #cbd5e1;

  .light & {
    color: #374151;
  }
}

.textarea {
  width: 100%;
  height: 128px;
  padding: 8px 12px;
  font-size: 14px;
  font-family: inherit;
  background: #1e293b;
  border: 1px solid #475569;
  border-radius: 8px;
  color: $dark-text;
  resize: none;

  &::placeholder {
    color: $dark-text-muted;
  }

  &:focus {
    outline: none;
    border-color: $purple;
    box-shadow: 0 0 0 2px rgba($purple, 0.2);
  }

  .light & {
    background: white;
    border-color: #d1d5db;
    color: $light-text;

    &::placeholder {
      color: $light-text-muted;
    }
  }
}

.revisionCount {
  font-size: 12px;
  margin-top: 8px;
  color: $dark-text-muted;

  .light & {
    color: $light-text-muted;
  }
}

.modalFooter {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  padding: 16px;
  border-top: 1px solid $dark-border;

  .light & {
    border-color: $light-border;
  }
}

.modalCancelButton {
  padding: 8px 16px;
  font-size: 14px;
  font-weight: 500;
  border: none;
  background: transparent;
  cursor: pointer;
  transition: color 0.15s ease;
  color: #cbd5e1;

  &:hover:not(:disabled) {
    color: $dark-text;
  }

  &:disabled {
    opacity: 0.5;
  }

  .light & {
    color: $light-text-secondary;

    &:hover:not(:disabled) {
      color: $light-text;
    }
  }
}

.modalSubmitButton {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  font-size: 14px;
  font-weight: 500;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.15s ease;
  background: $purple;
  color: white;

  &:hover:not(:disabled) {
    background: lighten($purple, 5%);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
}

.buttonSpinner {
  width: 16px;
  height: 16px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-top-color: white;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}
